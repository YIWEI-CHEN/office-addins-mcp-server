# Office Add-ins MCP Server - Copilot Instructions

## Overview

This MCP server provides tools for discovering and managing Microsoft Office Add-ins across Word, Excel, PowerPoint, Outlook, and Teams. The server exposes two primary MCP tools through the Model Context Protocol.

## Available MCP Tools

### 1. `search_addins` - Comprehensive Office Add-ins Search

**Purpose**: Search and filter Office Add-ins using comprehensive criteria including keywords, categories, client platforms, pricing, and more.

**Key Parameters**:
- `query` (str): Search keywords (searches both titles and descriptions)
- `category` (List[str]): Filter by categories like ["Productivity", "Communication", "Education"]
- `free` (bool): Filter for free add-ins (note: may include some paid add-ins with trials)
- `clients` (List[str]): Platform-product combinations (e.g., ["Win32_Excel", "Mac_Word", "WAC_PowerPoint"])
- `top` (int): Limit number of results (pagination)
- `skiptoitem` (int): Skip results for pagination (offset)
- `orderfield` (str): Sort by "Title", "Date", "Rating", "Price", or "None"
- `orderby` (str): Sort direction "Asc" or "Desc"

**Client Format**: Use `Platform_Product` format:
- Platforms: `Win32` (Windows), `Mac` (macOS), `WAC` (Web), `Any` (Power BI)
- Products: `Word`, `Excel`, `PowerPoint`, `Outlook`, `OneNote`, `PowerBI`
- Examples: `Win32_Excel`, `Mac_Word`, `WAC_PowerPoint`

**Common Use Cases**:
```
# Search for Zoom add-ins
search_addins(query="Zoom")

# Find free Excel add-ins sorted by rating
search_addins(query="charts", clients=["Win32_Excel"], free=True, orderfield="Rating", orderby="Desc", top=10)

# Get PowerPoint add-ins for presentations
search_addins(query="presentation template", clients=["Win32_PowerPoint", "WAC_PowerPoint"], top=15)

# Browse by category
search_addins(category=["Productivity", "Data Analytics"], orderfield="Rating", orderby="Desc")
```

### 2. `get_addin_details` - Detailed Add-in Information

**Purpose**: Retrieve comprehensive metadata for a specific Office add-in using its Asset ID.

**Parameters**:
- `asset_id` (str): The unique asset identifier (e.g., "WA104381441")

**Usage**:
```
# Get details for specific add-in
get_addin_details(asset_id="WA104381441")  # Zoom for Outlook add-in
```

## Response Formats

### Search Results Structure
```json
{
  "TotalCount": 387,
  "Values": [
    {
      "Id": "WA102957665",
      "Title": "Mini Calendar and Date Picker",
      "ShortDescription": "Add a mini monthly calendar...",
      "Rating": 2.13,
      "NumberOfVotes": 15,
      "DateReleased": "2012-06-28T12:00:00Z",
      "LastUpdatedDate": "2020-01-13T05:49:21Z",
      "Pricing": {
        "Category": "Free",
        "Price": "Free"
      },
      "Categories": [{"Id": "Reference", "Title": "Reference"}],
      "SupportedClients": [
        {
          "Client": "Win32_Excel",
          "DisplayName": "Excel 2013 Service Pack 1 or later on Windows"
        }
      ],
      "ProviderName": "VERTEX42"
    }
  ]
}
```

## Best Practices for Using These Tools

### 1. **Search Strategy**
- Start with broad queries, then narrow down with filters
- Use specific client filters when users mention Office applications
- Combine `free=True` with other filters for cost-conscious users
- Use pagination (`top` and `skiptoitem`) for large result sets

### 2. **Multiple Search Calls Strategy**
**IMPORTANT**: When users need comprehensive add-ins information or have complex requirements, you can make multiple `search_addins` calls to gather more complete results. However, **DO NOT exceed 3 search calls per user request** to maintain performance and avoid API rate limits.

**When to use multiple searches**:
- User asks for add-ins across multiple Office applications
- User wants both free and paid options compared
- User needs different categories or sorting approaches
- Initial search yields limited results and more exploration is needed

**Examples of effective multi-search patterns**:
```python
# Pattern 1: Compare across Office applications
search_addins(query="productivity", clients=["Win32_Excel"], top=10)
search_addins(query="productivity", clients=["Win32_Word"], top=10) 
search_addins(query="productivity", clients=["Win32_PowerPoint"], top=10)

# Pattern 2: Different sorting/filtering approaches
search_addins(query="charts", free=True, orderfield="Rating", top=15)
search_addins(query="charts", orderfield="Date", orderby="Desc", top=10)

# Pattern 3: Broad + specific searches
search_addins(category=["Data Analytics"], top=20)
search_addins(query="dashboard reporting", clients=["Win32_Excel"], top=15)
```

**Guidelines for multiple searches**:
- Make searches progressively more specific or explore different angles
- Vary parameters between calls (different clients, categories, sorting)
- Combine results intelligently and avoid duplicate recommendations
- Always stay within the 3-call limit per user request

### 3. **Sorting Recommendations**
- `orderfield="Rating"` + `orderby="Desc"` for quality-focused results
- `orderfield="Date"` + `orderby="Desc"` for newest add-ins
- `orderfield="Title"` + `orderby="Asc"` for alphabetical browsing

### 4. **Client Targeting**
When users mention specific Office applications:
- Excel → `clients=["Win32_Excel", "Mac_Excel", "WAC_Excel"]`
- Word → `clients=["Win32_Word", "Mac_Word", "WAC_Word"]`
- PowerPoint → `clients=["Win32_PowerPoint", "Mac_PowerPoint", "WAC_PowerPoint"]`
- Outlook → `clients=["Win32_Outlook", "Mac_Outlook", "WAC_Outlook"]`

### 5. **Common User Scenarios**

**Scenario**: "Find free Excel add-ins for data analysis"
```python
search_addins(
    query="data analysis", 
    clients=["Win32_Excel", "WAC_Excel"], 
    free=True, 
    orderfield="Rating", 
    orderby="Desc", 
    top=10
)
```

**Scenario**: "What are the most popular PowerPoint add-ins?"
```python
search_addins(
    clients=["Win32_PowerPoint", "Mac_PowerPoint", "WAC_PowerPoint"],
    orderfield="Rating",
    orderby="Desc",
    top=15
)
```

**Scenario**: "Find Outlook add-ins for calendar management"
```python
search_addins(
    query="calendar scheduling meeting",
    clients=["Win32_Outlook", "Mac_Outlook"],
    orderfield="Rating",
    orderby="Desc"
)
```

**Scenario**: "Show me productivity add-ins across all Office apps"
```python
search_addins(
    category=["Productivity"],
    orderfield="Rating",
    orderby="Desc",
    top=20
)
```

**Multi-Search Scenario**: "I need the best add-ins for Excel, Word, and PowerPoint for business presentations"
```python
# Call 1: Excel add-ins for data/charts
search_addins(
    query="charts data visualization business",
    clients=["Win32_Excel", "WAC_Excel"],
    orderfield="Rating",
    orderby="Desc",
    top=10
)

# Call 2: PowerPoint presentation add-ins
search_addins(
    query="presentation template design business",
    clients=["Win32_PowerPoint", "WAC_PowerPoint"],
    orderfield="Rating",
    orderby="Desc",
    top=10
)

# Call 3: Word document enhancement add-ins
search_addins(
    query="document formatting business writing",
    clients=["Win32_Word", "WAC_Word"],
    orderfield="Rating",
    orderby="Desc",
    top=10
)
```

### 6. **Error Handling**
- Invalid parameters are silently ignored (the API doesn't error)
- Asset IDs not found return empty results
- Network timeouts are handled automatically (30-second timeout)

### 7. **Pagination Guidelines**
- Default results are typically 20-50 items
- Use `top=10` for quick previews
- Use `top=50` or higher for comprehensive browsing
- Calculate next page: `skiptoitem = current_page * top`

### 8. **Categories to Suggest**
Common useful categories include:
- "Productivity" - Work efficiency tools
- "Data Analytics" - Analysis and visualization
- "Communication" - Email, chat, collaboration
- "Education" - Learning and training tools
- "Reference" - Documentation and lookup tools

## Integration Tips

1. **Always provide context** about the results (total count, current page)
2. **Highlight key information** like rating, price, and supported platforms
3. **Suggest related searches** based on results
4. **Use asset IDs** from search results to get detailed information
5. **Filter by platform** when users specify their Office version/OS

## Limitations

1. **Free filter caveat**: `free=True` may still return some paid add-ins with trial versions
2. **Regional filtering**: Limited support for non-English searches
3. **Real-time data**: Results reflect the Office Store at query time
4. **No authentication**: Currently read-only access to public add-in data

## Example Conversation Flow

**User**: "I need Excel add-ins for creating charts and graphs"

**Response Strategy**:
1. Use `search_addins(query="charts graphs visualization", clients=["Win32_Excel", "Mac_Excel", "WAC_Excel"], orderfield="Rating", orderby="Desc", top=15)`
2. Present top-rated results with ratings and descriptions
3. For promising add-ins, use `get_addin_details(asset_id="...")` for more information
4. Suggest related searches like "dashboard", "reporting", or "data visualization"

**Multi-Search Example**:
**User**: "I want to compare Office add-ins for project management across different apps"

**Response Strategy** (3 search calls maximum):
1. **Call 1**: `search_addins(query="project management task tracking", category=["Productivity"], orderfield="Rating", orderby="Desc", top=15)` - General project management add-ins
2. **Call 2**: `search_addins(query="project timeline gantt", clients=["Win32_Excel", "WAC_Excel"], top=10)` - Excel-specific project tools  
3. **Call 3**: `search_addins(query="team collaboration project", clients=["Win32_Outlook"], top=10)` - Outlook integration for project communication

**Result Processing**: Combine results from all 3 calls, remove duplicates, categorize by Office application, and present comprehensive comparison with ratings and features.

This MCP server enables rich Office add-in discovery and recommendation capabilities within AI conversations and workflows.